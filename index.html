<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Subscribe for Notifications</title>
</head>
<body>
  <h2>ðŸ”” Notification Subscribe</h2>
  <button onclick="subscribeUser()">Subscribe</button>

  <script>
    const publicKey = "YOUR_VAPID_PUBLIC_KEY";

    async function subscribeUser() {
      const registration = await navigator.serviceWorker.register("sw.js");
      const subscription = await registration.pushManager.subscribe({
        userVisibleOnly: true,
        applicationServerKey: urlBase64ToUint8Array(publicKey),
      });

      // Data send to Google Sheet
      fetch("https://script.google.com/macros/s/YOUR_GAS_URL/exec", {
        method: "POST",
        body: JSON.stringify(subscription),
      }).then(() => alert("Subscribed successfully!"));
    }

    function urlBase64ToUint8Array(base64String) {
      const padding = '='.repeat((4 - base64String.length % 4) % 4);
      const base64 = (base64String + padding)
        .replace(/\-/g, '+')
        .replace(/_/g, '/');
      const rawData = window.atob(base64);
      return Uint8Array.from([...rawData].map(char => char.charCodeAt(0)));
    }
  </script>
</body>
</html>